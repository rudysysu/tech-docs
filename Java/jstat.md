# Jstat

## Command
~~~bash
jstat -gc 24373 5000 100

every 5000ms, repeat 100 times
unit: KB, S
~~~

## Example1
~~~
[cloud-user@ip-192-168-1-236 ~]$ sudo /usr/java/jdk1.7.0_101/bin/jstat -gc 3988 5000 100
 S0C    S1C    S0U    S1U      EC       EU        OC         OU       PC     PU    YGC     YGCT    FGC    FGCT     GCT
813568.0 762880.0  0.0   536320.0 1027584.0   0.0    2056192.0  2022486.8  83968.0 63040.1     13    3.385   4      8.034   11.419
813568.0 762880.0  0.0   431373.2 1027584.0 569895.4 3115008.0  2055765.5  83968.0 63050.8     13    3.385   4     16.149   19.534
913408.0 913408.0  0.0   439488.0 913408.0   0.0    3115008.0  2990334.6  83968.0 63051.6     15    5.029   5     16.149   21.178
913408.0 913408.0  0.0   439488.0 913408.0   0.0    3115008.0  2990334.6  83968.0 63051.6     15    5.029   5     16.149   21.178
913408.0 913408.0  0.0   229192.3 913408.0 67342.9  4521472.0  3114772.8  83968.0 63064.5     15    5.029   5     28.590   33.620
901632.0 913408.0 881056.0 377984.0 901632.0 901632.0 4569600.0  4566550.4  83968.0 63149.2     19    6.934   5     28.590   35.525
913408.0 913408.0  0.0   435840.0 901632.0   0.0    4664320.0  4663886.4  83968.0 63149.2     19    8.175   6     28.590   36.766
913408.0 913408.0  0.0   435840.0 901632.0   0.0    4664320.0  4663886.4  83968.0 63149.2     19    8.175   6     28.590   36.766
913408.0 913408.0  0.0   435840.0 901632.0   0.0    4664320.0  4663886.4  83968.0 63149.2     19    8.175   6     28.590   36.766
913408.0 913408.0  0.0   276625.5 901632.0 299351.1 5480448.0  4664169.4  83968.0 63177.8     19    8.175   6     47.942   56.118
913408.0 913408.0  0.0   276625.5 901632.0 901632.0 5480448.0  4664169.4  83968.0 63177.8     19    8.175   7     47.942   56.118
913408.0 913408.0  0.0   276625.5 901632.0 901632.0 5480448.0  4664169.4  83968.0 63177.8     19    8.175   7     47.942   56.118
913408.0 913408.0  0.0   276625.5 901632.0 901632.0 5480448.0  4664169.4  83968.0 63177.8     19    8.175   7     47.942   56.118
913408.0 913408.0  0.0   276625.5 901632.0 901632.0 5480448.0  4664169.4  83968.0 63177.8     19    8.175   7     47.942   56.118
913408.0 913408.0  0.0    0.0   901632.0 901632.0 5480448.0  5324583.0  83968.0 63176.5     19    8.175   8     68.489   76.664
913408.0 913408.0  0.0    0.0   901632.0 901632.0 5480448.0  5324583.0  83968.0 63176.5     19    8.175   8     68.489   76.664
913408.0 913408.0  0.0    0.0   901632.0 901632.0 5480448.0  5324583.0  83968.0 63176.5     19    8.175   8     68.489   76.664
913408.0 913408.0  0.0    0.0   901632.0 901632.0 5480448.0  5324583.0  83968.0 63176.5     19    8.175   8     68.489   76.664
913408.0 913408.0  0.0    0.0   901632.0 901632.0 5480448.0  5480430.5  83968.0 63176.9     19    8.175   9     88.975   97.151
~~~

## Example2
把监控进程干掉，这样work进程就不会重启了。
~~~
[cloud-user@ip-192-168-1-236 ~]$ sudo /usr/java/jdk1.7.0_101/bin/jstat -gc 2133 5000 100
 S0C    S1C    S0U    S1U      EC       EU        OC         OU       PC     PU    YGC     YGCT    FGC    FGCT     GCT
913408.0 913408.0  0.0    0.0   913408.0 913408.0 5480448.0  5480129.0  75776.0 61346.1     20    8.922  16    265.369  274.291
913408.0 913408.0  0.0    0.0   913408.0 913408.0 5480448.0  5480129.0  75776.0 61346.1     20    8.922  16    265.369  274.291
913408.0 913408.0  0.0    0.0   913408.0 913408.0 5480448.0  5480129.0  75776.0 61346.1     20    8.922  16    265.369  274.291
913408.0 913408.0  0.0    0.0   913408.0 913408.0 5480448.0  5480129.0  75776.0 61346.1     20    8.922  16    265.369  274.291
913408.0 913408.0  0.0    0.0   913408.0 913408.0 5480448.0  5480129.0  75776.0 61346.1     20    8.922  16    265.369  274.291
913408.0 913408.0  0.0    0.0   913408.0 913408.0 5480448.0  5480271.5  73728.0 61350.3     20    8.922  17    303.565  312.487
913408.0 913408.0  0.0    0.0   913408.0 913408.0 5480448.0  5480271.5  73728.0 61350.3     20    8.922  17    303.565  312.487
913408.0 913408.0  0.0    0.0   913408.0 913408.0 5480448.0  5480271.5  73728.0 61350.3     20    8.922  17    303.565  312.487
913408.0 913408.0  0.0    0.0   913408.0 913408.0 5480448.0  5480271.5  73728.0 61350.3     20    8.922  17    303.565  312.487
913408.0 913408.0  0.0    0.0   913408.0 913408.0 5480448.0  5480271.5  73728.0 61350.3     20    8.922  17    303.565  312.487
913408.0 913408.0  0.0    0.0   913408.0 913408.0 5480448.0  5480271.5  73728.0 61350.3     20    8.922  17    303.565  312.487
913408.0 913408.0  0.0    0.0   913408.0 913408.0 5480448.0  5480271.5  73728.0 61350.3     20    8.922  17    303.565  312.487
913408.0 913408.0  0.0    0.0   913408.0 913408.0 5480448.0  5480271.5  73728.0 61350.3     20    8.922  17    303.565  312.487
~~~

## Can't jcmd, jps or jstat cassandra process within the docker container
- I know at least two possible reasons why this can happen.
  - Java is run with -XX:+PerfDisableSharedMem option. This option helps sometimes to reduce JVM safepoint pauses, but it also makes JVM invisible to jps and jstat. This is a very likely case, because you are running Cassandra, and recent Cassandra has this option ON by default.
  - Java process has a different mount namespace, so that /tmp of Java process is not physically the same directory as /tmp of your shell. The directory /tmp/hsperfdata_root must be accessible in order to use jps or jstat. This is also a plausible reason since you are using docker containers.
